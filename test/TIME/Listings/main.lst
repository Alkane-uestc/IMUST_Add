C51 COMPILER V9.60.7.0   MAIN                                                              12/22/2024 20:57:19 PAGE 1   


C51 COMPILER V9.60.7.0, COMPILATION OF MODULE MAIN
OBJECT MODULE PLACED IN .\Objects\main.obj
COMPILER INVOKED BY: D:\Sofeware\MDK536\C51\BIN\C51.EXE main.c OPTIMIZE(8,SPEED) BROWSE DEBUG OBJECTEXTEND PRINT(.\Listi
                    -ngs\main.lst) TABS(2) OBJECT(.\Objects\main.obj)

line level    source

   1          #include <REGX52.H>
   2          
   3          // å®šä¹‰DA1ç¯æ‰€è¿æ¥çš„å¼•è„šï¼Œè¿™é‡Œå‡è®¾DA1ç¯è¿æ¥åœ¨P1.0å¼•è„šï¼Œä½ å¯æ ¹æ®å®é™…æƒ…å†µä¿®æ”¹
   4          sbit DA1 = P1^0;  
   5          
   6          // å®šæ—¶å™¨0åˆå§‹åŒ–å‡½æ•°å£°æ˜
   7          void Timer0_Init(void);
   8          // ç®€å•å»¶æ—¶å‡½æ•°å£°æ˜ï¼Œç”¨äºä¸€äº›éç²¾ç¡®å»¶æ—¶åœºæ™¯
   9          void Delay(unsigned int xms);
  10          
  11          // å…¨å±€å˜é‡ï¼Œç”¨äºæ§åˆ¶å‘¼å¸ç¯çš„PWMå ç©ºæ¯”
  12          unsigned char pwm_duty = 0;  
  13          // å…¨å±€å˜é‡ï¼Œç”¨äºæ§åˆ¶å‘¼å¸ç¯å ç©ºæ¯”çš„å¢å‡æ–¹å‘ï¼Œ1è¡¨ç¤ºå¢åŠ ï¼ˆå˜äº®ï¼‰ï¼Œ0è¡¨ç¤ºå‡å°
             -ï¼ˆå˜æš—ï¼‰
  14          unsigned char pwm_direction = 1;  
  15          
  16          // å®šæ—¶å™¨0åˆå§‹åŒ–å‡½æ•°ï¼Œé…ç½®å®šæ—¶å™¨0ç›¸å…³å¯„å­˜å™¨ï¼Œä½¿å…¶ä»¥åˆé€‚çš„å®šæ—¶å‘¨æœŸå·¥ä½œå¹¶å¼
             -€å¯ä¸­æ–­
  17          void Timer0_Init(void)
  18          {
  19   1          TMOD &= 0xF0;  // å…ˆæ¸…é™¤TMODå¯„å­˜å™¨çš„ä½4ä½ï¼Œè®¾ç½®å®šæ—¶å™¨0å·¥ä½œæ¨¡å¼
  20   1          TMOD |= 0x01;  // è®¾ç½®å®šæ—¶å™¨0ä¸ºæ¨¡å¼1ï¼ˆ16ä½å®šæ—¶å™¨/è®¡æ•°å™¨ï¼‰
  21   1          // é‡æ–°è®¡ç®—çš„å®šæ—¶å™¨åˆå€¼ï¼Œç”¨äºå®ç°å¤§çº¦1ç§’çš„å®šæ—¶å‘¨æœŸï¼ˆåŸºäº12MHzæ™¶æŒ¯ï¼‰
  22   1          TH0 = 0x3C;  
  23   1          TL0 = 0xB0;
  24   1          ET0 = 1;       // å…è®¸å®šæ—¶å™¨0ä¸­æ–­
  25   1          EA = 1;        // æ‰“å¼€æ€»ä¸­æ–­å…è®¸ä½
  26   1          TR0 = 1;       // å¯åŠ¨å®šæ—¶å™¨0å¼€å§‹è®¡æ•°
  27   1      }
  28          
  29          // ç®€å•çš„å»¶æ—¶å‡½æ•°ï¼Œé€šè¿‡å¾ªç¯æ¶ˆè€—æ—¶é—´æ¥å®ç°å¤§è‡´çš„æ¯«ç§’çº§å»¶æ—¶
  30          void Delay(unsigned int xms)
  31          {
  32   1          unsigned char i, j;
  33   1          while (xms--)
  34   1          {
  35   2              i = 2;
  36   2              j = 239;
  37   2              do
  38   2              {
  39   3                  while (--j);
  40   3              } while (--i);
  41   2          }
  42   1      }
  43          
  44          // å®šæ—¶å™¨0ä¸­æ–­æœåŠ¡å‡½æ•°ï¼Œåœ¨è¿™é‡Œå®ç°8ä¸ªLEDä¾æ¬¡ç‚¹äº®ä»¥åŠDA1ç¯å‘¼å¸ç¯æ•ˆæœçš„é€»è¾‘
  45          void Timer0Interrupt() interrupt 1
  46          {
  47   1          static unsigned char led_count = 0;  // ç”¨äºè®°å½•å½“å‰è¦æ“ä½œçš„LEDåºå·ï¼Œé™æ€å˜é‡ä¿æŒå€
             -¼
  48   1          static unsigned char pwm_count = 0;  // ç”¨äºå‘¼å¸ç¯æ•ˆæœè®¡æ•°ï¼Œè®°å½•å®šæ—¶ä¸­æ–­æ¬¡æ•°
  49   1      
  50   1          // é‡æ–°è£…å…¥å®šæ—¶å™¨0åˆå€¼ï¼Œä¿è¯å®šæ—¶å‘¨æœŸç¨³å®šï¼Œçº¦1ç§’ï¼ˆ12MHzæ™¶æŒ¯ä¸‹ï¼‰
  51   1          TH0 = 0x3C;  
C51 COMPILER V9.60.7.0   MAIN                                                              12/22/2024 20:57:19 PAGE 2   

  52   1          TL0 = 0xB0;
  53   1      
  54   1          // æ§åˆ¶8ä¸ªLEDä¾æ¬¡ç‚¹äº®ï¼Œæ¯8æ¬¡å®šæ—¶å™¨ä¸­æ–­åˆ‡æ¢ä¸€æ¬¡ç‚¹äº®çš„LEDï¼ˆå³çº¦æ¯8ç§’åˆ‡æ¢ä¸€
             -æ¬¡ï¼‰
  55   1          if (++pwm_count >= 8)
  56   1          {
  57   2              pwm_count = 0;
  58   2              P2 = ~(0x01 << led_count);  // é€šè¿‡ä½æ“ä½œä¾æ¬¡ç‚¹äº®è¿æ¥åœ¨P2å£çš„8ä¸ªLEDï¼ˆä½ç”µå¹³ç‚¹ä
             -º®ï¼‰
  59   2              if (++led_count >= 8)
  60   2              {
  61   3                  led_count = 0;
  62   3              }
  63   2          }
  64   1      
  65   1          // æ§åˆ¶å‘¼å¸ç¯æ•ˆæœï¼Œæ¯10æ¬¡å®šæ—¶å™¨ä¸­æ–­ï¼ˆå³çº¦æ¯10ç§’ï¼‰è°ƒæ•´ä¸€æ¬¡PWMå ç©ºæ¯”
  66   1          if (++pwm_count % 10 == 0)  
  67   1          {
  68   2              if (pwm_direction)
  69   2              {
  70   3                  pwm_duty++;
  71   3                  if (pwm_duty >= 100)  // é™åˆ¶å ç©ºæ¯”æœ€å¤§å€¼ï¼Œè¾¾åˆ°æœ€å¤§å€¼åå¼€å§‹å˜æš—
  72   3                  {
  73   4                      pwm_direction = 0;
  74   4                  }
  75   3              }
  76   2              else
  77   2              {
  78   3                  pwm_duty--;
  79   3                  if (pwm_duty <= 0)  // é™åˆ¶å ç©ºæ¯”æœ€å°å€¼ï¼Œè¾¾åˆ°æœ€å°å€¼åå¼€å§‹å˜äº®
  80   3                  {
  81   4                      pwm_direction = 1;
  82   4                  }
  83   3              }
  84   2          }
  85   1      
  86   1          // æ ¹æ®å½“å‰çš„PWMå ç©ºæ¯”æ§åˆ¶DA1ç¯çš„äº®ç­ï¼Œå®ç°å‘¼å¸ç¯æ•ˆæœ
  87   1          if (pwm_count < pwm_duty)
  88   1          {
  89   2              DA1 = 0;  // ç‚¹äº®DA1ç¯ï¼ˆå‡è®¾ä½ç”µå¹³ç‚¹äº®ï¼ŒæŒ‰å®é™…ç¡¬ä»¶è°ƒæ•´ï¼‰
  90   2          }
  91   1          else
  92   1          {
  93   2              DA1 = 1;  // ç†„ç­DA1ç¯
  94   2          }
  95   1      }
  96          
  97          // ä¸»å‡½æ•°ï¼Œç¨‹åºå…¥å£
  98          void main()
  99          {
 100   1          Timer0_Init();  // åˆå§‹åŒ–å®šæ—¶å™¨0
 101   1          while (1)
 102   1          {
 103   2              // ä¸»å¾ªç¯å¯æ·»åŠ å…¶ä»–åŠŸèƒ½ä»£ç ï¼Œè¿™é‡Œæš‚æ—¶ä¸ºç©ºï¼Œç­‰å¾…å®šæ—¶å™¨ä¸­æ–­å®ç°ç¯å…‰æ•
             -ˆæœ
 104   2          }
 105   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    170    ----
   CONSTANT SIZE    =   ----    ----
C51 COMPILER V9.60.7.0   MAIN                                                              12/22/2024 20:57:19 PAGE 3   

   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =      4    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
